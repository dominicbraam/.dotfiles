#!/bin/bash

function send_notification() {
    volume=$(awk -F"[][]" '/Left:/ { gsub(/%/,"",$2); print $2 }' <(amixer sget Master))
    dunstify -a "changevolume" -u low -t 500 -r 9993 -i "$HOME/.dotfiles/icons/volume-$1.png" -h int:value:"$volume" "Volume: ${volume}%"
}

case $1 in

up)
    # Set the volume on (if it was muted)
    amixer set Master unmute
    amixer set Master 5%+
    send_notification "$1"
    ;;

down)
    amixer set Master unmute
    amixer set Master 5%-
    send_notification "$1"
    ;;

mute)
    if amixer sget Master | grep -q '\[on\]'; then
        amixer set Master mute
        dunstify -a "changevolume" -u low -t 500 -r 9993 -i "$HOME/.dotfiles/icons/volume-mute.png" "Muted"
    else
        amixer set Master unmute
        send_notification up
    fi
    ;;

esac
